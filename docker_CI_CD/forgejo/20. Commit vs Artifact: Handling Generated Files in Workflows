An artifact is a file or set of files produced by a CI/CD workflow that you want to store, share, or use in later steps/jobs.
In CI/CD, artifacts can include:
- Build outputs (e.g., binaries, Docker images)
- Configuration files
- Logs, reports, or test results
- Backups or temporary files

Key points:
- Artifacts are usually ephemeral ‚Äî they exist for the duration of the workflow or for a configurable retention period.
- They allow you to pass files between jobs without committing them to Git.
- In Forgejo (self-hosted Git with GitHub Actions compatibility), artifacts are uploaded using actions/upload-artifact and can be downloaded by other jobs using actions/download-artifact.
- Unlike Git commits, artifacts do not create a permanent history; they are intended for temporary sharing and pipeline use.


1Ô∏è‚É£ Committing generated files back to Git
git add ./backup
git commit -m "Backup configs"
git push origin HEAD

2Ô∏è‚É£ Returning generated files as artifacts
- uses: actions/upload-artifact@v3
  with:
    name: backup-configs
    path: ./backup

‚öñÔ∏è Comparison Table

| Feature / Aspect               | Commit to Git                      | Artifact                              |
| ------------------------------ | ---------------------------------- | ------------------------------------- |
| **Versioning**                 | ‚úÖ Full Git history                 | ‚ùå No history (ephemeral)              |
| **Repo cleanliness**           | ‚ö†Ô∏è Clutters repo if large/frequent | ‚úÖ Repo stays clean                    |
| **File size & frequency**      | ‚ö†Ô∏è Problematic for large/frequent  | ‚úÖ Handles large/frequent files        |
| **Sharing between jobs**       | ‚ö†Ô∏è Requires `git clone`            | ‚úÖ Direct download in jobs             |
| **Access after workflow ends** | ‚úÖ Always available in repo         | ‚ö†Ô∏è Only via workflow/artifact storage |
| **Security / sensitive data**  | ‚ö†Ô∏è Risky if repo is shared         | ‚úÖ Can be restricted to workflow jobs  |
| **Triggering extra workflows** | ‚ö†Ô∏è Push may trigger CI loops       | ‚úÖ Doesn‚Äôt trigger Git events          |


üí° Workflow Example

name: BACKUP

on:
  workflow_dispatch:

jobs:
  run-backup:
    runs-on: ubuntu-22.04

    env:
      DEVICE_USERNAME: ${{ secrets.DEVICE_USERNAME }}
      DEVICE_PASSWORD: ${{ secrets.DEVICE_PASSWORD }}

    steps:
      - name: Check out repository
        uses: actions/checkout@v4

      - name: Ensure Forgejo hostname is resolvable
        run: |
          if ! grep -q "forgejo.rayka-co.com" /etc/hosts; then
            echo "10.13.14.30 forgejo.rayka-co.com" | sudo tee -a /etc/hosts
          fi
          echo "Verifying resolution:"
          ping -c 2 forgejo.rayka-co.com || true

      - name: Make Backup script executable
        run: chmod +x backup.py

      - name: Install Python and pip
        run: |
          apt-get update
          apt-get install -y python3 python3-pip

      - name: Install Python dependencies
        run: |
          python3 -m pip install --upgrade pip
          python3 -m pip install nornir nornir-utils nornir-jinja2 netmiko jinja2 nornir-scrapli

      - name: Copy SSH legacy config
        run: |
          mkdir -p /etc/ssh/ssh_config.d
          cp config/legacy.conf /etc/ssh/ssh_config.d/legacy.conf

      - name: Run Backup script
        run: |
          echo "The workspace directory is: ${{ github.workspace }}"
          cd ${{ github.workspace }}
          ./backup.py

      - name: Upload backup folder as artifact
        uses: actions/upload-artifact@v3
        with:
          name: backup-configs
          path: ./backup
          if-no-files-found: warn

      - name: Commit generated configs (if any)
        run: |
          echo "Listing generated configs in ./backup:"
          ls -l ./backup || echo "No configs found"

          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"

          CHANGED=$(git status --porcelain ./backup)
          if [ -n "$CHANGED" ]; then
            git add ./backup
            git commit -m "Backup configs"
            git push origin HEAD
          else
            echo "No changes to commit"
          fi


  # üß™ Test job: Download and inspect the uploaded artifact
  verify-artifact:
    runs-on: ubuntu-22.04
    needs: run-backup

    steps:
      - name: Ensure Forgejo hostname is resolvable
        run: |
          if ! grep -q "forgejo.rayka-co.com" /etc/hosts; then
            echo "10.13.14.30 forgejo.rayka-co.com" | sudo tee -a /etc/hosts
          fi

      - name: Download artifact from previous job
        uses: actions/download-artifact@v3
        with:
          name: backup-configs
          path: ./downloaded-backups

      - name: List downloaded artifact contents
        run: |
          echo "‚úÖ Listing downloaded backup files:"
          ls -R ./downloaded-backups || echo "No files found"

      - name: Show first few lines of each backup file
        run: |
          for f in ./downloaded-backups/*; do
            echo "----- $f -----"
            head -n 5 "$f"
            echo
          done || echo "No backup files to show"
